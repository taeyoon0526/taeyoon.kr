<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard | taeyoon.kr</title>
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âš¡</text></svg>">
  <style>
    :root {
      --bg-gradient-start: #667eea;
      --bg-gradient-end: #764ba2;
      --card-bg: rgba(255, 255, 255, 0.95);
      --text-primary: #1f2933;
      --text-secondary: #52616b;
      --border-color: #e4e7eb;
      --hover-bg: #f8f9fb;
      --accent: #667eea;
      --shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --info: #3b82f6;
    }

    body.dark-mode {
      --bg-gradient-start: #1a1a2e;
      --bg-gradient-end: #16213e;
      --card-bg: rgba(30, 30, 46, 0.95);
      --text-primary: #e4e7eb;
      --text-secondary: #a8b2d1;
      --border-color: #2d3748;
      --hover-bg: #2a3142;
      --accent: #8b5cf6;
      --shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
      min-height: 100vh;
      padding: 1.5rem;
      color: var(--text-primary);
      transition: background 0.3s ease;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .header {
      background: var(--card-bg);
      border-radius: 24px;
      padding: 2.5rem 3rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
    }

    .header-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .header h1 {
      font-size: 2.5rem;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .header p {
      color: var(--text-secondary);
      font-size: 1.15rem;
      margin-top: 0.75rem;
    }

    .theme-toggle {
      background: var(--accent);
      color: white;
      border: none;
      padding: 0.75rem 1.25rem;
      border-radius: 16px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      font-weight: 600;
    }

    .theme-toggle:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
    }

    .theme-toggle:active {
      transform: translateY(0);
    }

    .section {
      background: var(--card-bg);
      border-radius: 24px;
      padding: 2.5rem 3rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow);
    }

    .section h2 {
      font-size: 1.85rem;
      color: var(--text-primary);
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .section p {
      color: var(--text-secondary);
      margin-bottom: 1.5rem;
      line-height: 1.6;
      font-size: 1.05rem;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1.5rem;
    }

    /* 3ì—´ ê·¸ë¦¬ë“œ (GET API ì„¹ì…˜ìš©) */
    .grid-3col {
      grid-template-columns: repeat(3, 1fr);
    }

    .card {
      background: var(--hover-bg);
      border: 2px solid var(--border-color);
      border-radius: 20px;
      padding: 2rem;
      transition: all 0.3s ease;
      cursor: pointer;
      text-decoration: none;
      display: block;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 32px rgba(102, 126, 234, 0.2);
      border-color: var(--accent);
    }

    .card:active {
      transform: translateY(-2px);
    }

    .card-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
    }

    .card-title {
      font-size: 1.35rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 0.75rem;
    }

    .card-desc {
      font-size: 1rem;
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 1rem;
    }

    .card-badge {
      display: inline-block;
      padding: 0.4rem 0.85rem;
      border-radius: 12px;
      font-size: 0.85rem;
      font-weight: 600;
    }

    .badge-get {
      background: rgba(59, 130, 246, 0.15);
      color: #3b82f6;
    }

    .badge-post {
      background: rgba(16, 185, 129, 0.15);
      color: #10b981;
    }

    .badge-dashboard {
      background: rgba(139, 92, 246, 0.15);
      color: #8b5cf6;
    }

    .quick-actions {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 1rem 1.75rem;
      border-radius: 16px;
      font-size: 1.05rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn-success {
      background: var(--success);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    }

    .btn-success:hover {
      box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4);
    }

    .endpoint-path {
      font-family: 'SF Mono', 'Courier New', monospace;
      background: var(--card-bg);
      padding: 0.6rem 0.9rem;
      border-radius: 8px;
      font-size: 0.9rem;
      color: var(--accent);
      margin-top: 0.75rem;
      display: inline-block;
      border: 1px solid var(--border-color);
    }

    .stats-banner {
      background: linear-gradient(135deg, var(--accent) 0%, #8b5cf6 100%);
      color: white;
      border-radius: 20px;
      padding: 2.5rem;
      text-align: center;
      margin-bottom: 2rem;
      box-shadow: var(--shadow);
    }

    .stats-banner h3 {
      font-size: 1.75rem;
      margin-bottom: 0.5rem;
    }

    .stats-banner p {
      opacity: 0.95;
      font-size: 1.1rem;
    }

    @media (max-width: 768px) {
      body {
        padding: 1rem;
      }

      .header {
        padding: 1.5rem;
      }

      .header h1 {
        font-size: 1.75rem;
      }

      .header p {
        font-size: 1rem;
      }

      .section {
        padding: 1.5rem;
      }

      .section h2 {
        font-size: 1.35rem;
      }

      .section p {
        font-size: 0.95rem;
      }

      .grid,
      .grid-3col {
        grid-template-columns: 1fr;
      }

      .card-icon {
        font-size: 2.5rem;
      }

      .card-title {
        font-size: 1.15rem;
      }

      .card-desc {
        font-size: 0.9rem;
      }

      .quick-actions {
        flex-direction: column;
      }

      .btn {
        width: 100%;
        justify-content: center;
        font-size: 1rem;
        padding: 0.85rem 1.25rem;
      }

      .stats-banner {
        padding: 2rem;
      }

      .stats-banner h3 {
        font-size: 1.35rem;
      }

      .stats-banner p {
        font-size: 1rem;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <div class="header-top">
        <div>
          <h1>âš¡ Admin Dashboard</h1>
          <p>taeyoon.kr ì „ì²´ ì‹œìŠ¤í…œ ê´€ë¦¬ ì„¼í„°</p>
        </div>
        <button id="themeToggle" class="theme-toggle">ğŸŒ™ ë‹¤í¬</button>
      </div>
    </div>

    <div class="stats-banner">
      <h3>ğŸš€ ì‹œìŠ¤í…œ ì •ìƒ ê°€ë™ ì¤‘</h3>
      <p>ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸ì™€ ëŒ€ì‹œë³´ë“œê°€ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤</p>
    </div>

    <div class="section">
      <h2>ğŸ“Š ëŒ€ì‹œë³´ë“œ</h2>
      <p>ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ì‹œê°í™”í•˜ì—¬ í™•ì¸í•  ìˆ˜ ìˆëŠ” ëŒ€ì‹œë³´ë“œì…ë‹ˆë‹¤.</p>
      <div class="grid">
        <a href="/visitor/dashboard" class="card">
          <div class="card-icon">ğŸ›¡ï¸</div>
          <div class="card-title">ë³´ì•ˆ ëª¨ë‹ˆí„°ë§</div>
          <div class="card-desc">ì‹¤ì‹œê°„ ë³´ì•ˆ ìœ„í˜‘, ì°¨ë‹¨ëœ IP, ì˜ì‹¬ í™œë™ ì¶”ì . Chart.js ê·¸ë˜í”„ì™€ ë‹¤í¬ëª¨ë“œ ì§€ì›.</div>
          <span class="card-badge badge-dashboard">DASHBOARD</span>
          <div class="endpoint-path">/visitor/dashboard</div>
        </a>
        <a href="/visitor/stats" class="card">
          <div class="card-icon">ğŸ“ˆ</div>
          <div class="card-title">ë°©ë¬¸ì í†µê³„</div>
          <div class="card-desc">êµ­ê°€ë³„, ê²½ë¡œë³„, ì‹œê°„ëŒ€ë³„ ë°©ë¬¸ì ë¶„ì„. ì‹¤ì‹œê°„ ë° ëˆ„ì  ë°ì´í„° ì œê³µ.</div>
          <span class="card-badge badge-dashboard">DASHBOARD</span>
          <div class="endpoint-path">/visitor/stats</div>
        </a>
        <a href="/visitor/analytics" class="card">
          <div class="card-icon">ğŸ“Š</div>
          <div class="card-title">ìƒì„¸ ë¶„ì„</div>
          <div class="card-desc">ë°©ë¬¸ì ìƒì„¸ ë¶„ì„ ëŒ€ì‹œë³´ë“œ. ë°ì´í„° ì‹œê°í™” ë° íŠ¸ë Œë“œ ë¶„ì„.</div>
          <span class="card-badge badge-dashboard">DASHBOARD</span>
          <div class="endpoint-path">/visitor/analytics</div>
        </a>
        <a href="/visitor/logs" class="card">
          <div class="card-icon">ğŸ“</div>
          <div class="card-title">ë°©ë¬¸ ë¡œê·¸</div>
          <div class="card-desc">í˜ì´ì§€ë„¤ì´ì…˜ ì§€ì› ë°©ë¬¸ ë¡œê·¸. ì‹œê°„ë³„, í•„í„°ë³„ ë¡œê·¸ ì¡°íšŒ ê°€ëŠ¥.</div>
          <span class="card-badge badge-dashboard">DASHBOARD</span>
          <div class="endpoint-path">/visitor/logs</div>
        </a>
      </div>
    </div>

    <div class="section">
      <h2>ğŸ” ì¡°íšŒ API (GET)</h2>
      <p>ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ” ì½ê¸° ì „ìš© API ì—”ë“œí¬ì¸íŠ¸ì…ë‹ˆë‹¤.</p>
      <div class="grid grid-3col">
        <a href="/ip" class="card">
          <div class="card-icon">ğŸŒ</div>
          <div class="card-title">ë‚´ IP í™•ì¸</div>
          <div class="card-desc">í˜„ì¬ ì ‘ì† ì¤‘ì¸ IP ì£¼ì†Œì™€ êµ­ê°€, User Agent ì •ë³´ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.</div>
          <span class="card-badge badge-get">GET</span>
          <div class="endpoint-path">/ip</div>
        </a>
        <a href="/api/visitor/data" class="card">
          <div class="card-icon">ğŸ“Š</div>
          <div class="card-title">ë°©ë¬¸ì ë°ì´í„°</div>
          <div class="card-desc">ì „ì²´ ë°©ë¬¸ì ë°ì´í„° ì¡°íšŒ (ì¸ì¦ í•„ìš”). IP ë§ˆìŠ¤í‚¹ ì ìš©ë¨.</div>
          <span class="card-badge badge-get">GET</span>
          <div class="endpoint-path">/api/visitor/data</div>
        </a>
        <a href="/visitor/security-stats" class="card">
          <div class="card-icon">ï¿½</div>
          <div class="card-title">ë³´ì•ˆ í†µê³„ ì¡°íšŒ</div>
          <div class="card-desc">ì°¨ë‹¨ëœ IP, ì˜ì‹¬ í™œë™, Rate Limit í˜„í™©ì„ JSONìœ¼ë¡œ ë°˜í™˜.</div>
          <span class="card-badge badge-get">GET</span>
          <div class="endpoint-path">/visitor/security-stats</div>
        </a>
      </div>
    </div>

    <div class="section">
      <h2>âš™ï¸ ì‹¤í–‰ API (POST)</h2>
      <p>ì‹œìŠ¤í…œ ì‘ì—…ì„ ì‹¤í–‰í•˜ëŠ” API ì—”ë“œí¬ì¸íŠ¸ì…ë‹ˆë‹¤. ì•„ë˜ ë²„íŠ¼ìœ¼ë¡œ ë°”ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
      <div class="grid">
        <div class="card" style="cursor: default; border-color: var(--success);">
          <div class="card-icon">ğŸ“§</div>
          <div class="card-title">ë³´ì•ˆ ìš”ì•½ ì´ë©”ì¼</div>
          <div class="card-desc">í˜„ì¬ ë³´ì•ˆ ìƒí™©ì„ me@taeyoon.krë¡œ ì „ì†¡. ?to íŒŒë¼ë¯¸í„°ë¡œ ìˆ˜ì‹ ì ë³€ê²½ ê°€ëŠ¥.</div>
          <span class="card-badge badge-post">POST</span>
          <div class="endpoint-path">/visitor/security-summary</div>
          <button onclick="sendSecuritySummary()" class="btn btn-success" style="margin-top: 1rem; width: 100%;">ğŸ“§ ìš”ì•½
            ì „ì†¡</button>
        </div>
        <div class="card" style="cursor: default;">
          <div class="card-icon">ğŸ¤</div>
          <div class="card-title">IP ì‹ ë¢° ê´€ë¦¬</div>
          <div class="card-desc">íŠ¹ì • IPë¥¼ ì‹ ë¢° ëª©ë¡ì— ì¶”ê°€/ì œê±°í•©ë‹ˆë‹¤.</div>
          <span class="card-badge badge-post">POST</span>
          <div class="endpoint-path">/visitor/trust-ip</div>
          <div class="endpoint-path" style="margin-left: 0.5rem;">/visitor/untrust-ip</div>
          <div style="margin-top: 1rem;">
            <input type="text" id="trustIpInput" placeholder="IP ì£¼ì†Œ ì…ë ¥ (ì˜ˆ: 1.2.3.4)"
              style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 8px; margin-bottom: 10px;">
            <div style="display: flex; gap: 10px;">
              <button onclick="trustIP()" class="btn btn-success" style="flex: 1;">âœ… ì‹ ë¢° ì¶”ê°€</button>
              <button onclick="untrustIP()" class="btn" style="flex: 1; background: #f56565; color: white;">âŒ ì‹ ë¢°
                ì œê±°</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>ğŸ”§ ë¹ ë¥¸ ì‘ì—…</h2>
      <p>ìì£¼ ì‚¬ìš©í•˜ëŠ” ì‘ì—…ì„ ë¹ ë¥´ê²Œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
      <div class="quick-actions">
        <a href="/visitor/dashboard" class="btn">ğŸ›¡ï¸ ë³´ì•ˆ ëŒ€ì‹œë³´ë“œ</a>
        <a href="/visitor/stats" class="btn">ğŸ“ˆ ë°©ë¬¸ì í†µê³„</a>
        <button onclick="sendSecuritySummary()" class="btn btn-success">ğŸ“§ ìš”ì•½ ì „ì†¡</button>
        <button onclick="window.location.reload()" class="btn">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
      </div>
    </div>

    <div class="section" style="background: var(--hover-bg); border: 2px dashed var(--border-color);">
      <h2>ğŸ“š API ë¬¸ì„œ</h2>
      <p style="margin-bottom: 0.5rem;"><strong>ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ëŠ” taeyoon.kr ë„ë©”ì¸ì—ì„œ ì‘ë™í•©ë‹ˆë‹¤.</strong></p>
      <p style="font-size: 0.9rem; color: var(--text-secondary);">
        â€¢ GET ì—”ë“œí¬ì¸íŠ¸ëŠ” ë¸Œë¼ìš°ì €ì—ì„œ ì§ì ‘ ì ‘ì† ê°€ëŠ¥<br>
        â€¢ POST ì—”ë“œí¬ì¸íŠ¸ëŠ” curl, Postman, fetch() ë“±ìœ¼ë¡œ í˜¸ì¶œ<br>
        â€¢ ëª¨ë“  ì‘ë‹µì€ JSON í˜•ì‹ (ëŒ€ì‹œë³´ë“œ ì œì™¸)<br>
        â€¢ Rate Limit ë° ë³´ì•ˆ ì •ì±… ìë™ ì ìš©
      </p>
    </div>
  </div>
  <script>
    let darkMode = localStorage.getItem('darkMode') === 'true' || window.matchMedia('(prefers-color-scheme: dark)').matches;

    function setDarkMode(enabled) {
      darkMode = enabled;
      document.body.classList.toggle('dark-mode', enabled);
      localStorage.setItem('darkMode', enabled);
      document.getElementById('themeToggle').textContent = enabled ? 'â˜€ï¸ ë¼ì´íŠ¸' : 'ğŸŒ™ ë‹¤í¬';
    }
    setDarkMode(darkMode);

    document.getElementById('themeToggle').onclick = () => setDarkMode(!darkMode);

    async function sendSecuritySummary() {
      const btn = event.target;
      const originalText = btn.textContent;
      btn.disabled = true;
      btn.textContent = 'ğŸ“¤ ì „ì†¡ ì¤‘...';
      try {
        const r = await fetch('/visitor/security-summary', { method: 'POST' });
        const j = await r.json();
        if (j.success) {
          btn.textContent = 'âœ… ì „ì†¡ ì™„ë£Œ!';
          setTimeout(() => { btn.textContent = originalText; btn.disabled = false; }, 2000);
        } else {
          alert('ì „ì†¡ ì‹¤íŒ¨: ' + (j.message || 'ì•Œ ìˆ˜ ì—†ìŒ'));
          btn.textContent = originalText;
          btn.disabled = false;
        }
      } catch (e) {
        alert('ì „ì†¡ ì‹¤íŒ¨: ' + e.message);
        btn.textContent = originalText;
        btn.disabled = false;
      }
    }

    async function trustIP() {
      const ip = document.getElementById('trustIpInput').value.trim();
      if (!ip) {
        alert('IP ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      if (!/^(\d{1,3}\.){3}\d{1,3}$/.test(ip)) {
        alert('ì˜¬ë°”ë¥¸ IP ì£¼ì†Œ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. (ì˜ˆ: 1.2.3.4)');
        return;
      }
      try {
        const r = await fetch('/visitor/trust-ip', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ ip })
        });
        const j = await r.json();
        if (j.success) {
          alert('âœ… IPê°€ ì‹ ë¢° ëª©ë¡ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤: ' + ip);
          document.getElementById('trustIpInput').value = '';
        } else {
          alert('âŒ ì¶”ê°€ ì‹¤íŒ¨: ' + (j.message || 'ì•Œ ìˆ˜ ì—†ìŒ'));
        }
      } catch (e) {
        alert('âŒ ì˜¤ë¥˜: ' + e.message);
      }
    }

    async function untrustIP() {
      const ip = document.getElementById('trustIpInput').value.trim();
      if (!ip) {
        alert('IP ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      if (!/^(\d{1,3}\.){3}\d{1,3}$/.test(ip)) {
        alert('ì˜¬ë°”ë¥¸ IP ì£¼ì†Œ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. (ì˜ˆ: 1.2.3.4)');
        return;
      }
      if (!confirm('ì •ë§ë¡œ ì´ IPë¥¼ ì‹ ë¢° ëª©ë¡ì—ì„œ ì œê±°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\\n\\nIP: ' + ip)) {
        return;
      }
      try {
        const r = await fetch('/visitor/untrust-ip', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ ip })
        });
        const j = await r.json();
        if (j.success) {
          alert('âœ… IPê°€ ì‹ ë¢° ëª©ë¡ì—ì„œ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤: ' + ip);
          document.getElementById('trustIpInput').value = '';
        } else {
          alert('âŒ ì œê±° ì‹¤íŒ¨: ' + (j.message || 'ì•Œ ìˆ˜ ì—†ìŒ'));
        }
      } catch (e) {
        alert('âŒ ì˜¤ë¥˜: ' + e.message);
      }
    }

    // ====================================
    // ì‹¤ì‹œê°„ ë°ì´í„° ë¡œë“œ
    // ====================================
    async function loadRealTimeStats() {
      try {
        // ë°©ë¬¸ì ë°ì´í„° ë¡œë“œ
        const visitorResponse = await fetch('/api/visitor/data');
        const visitorData = await visitorResponse.json();
        
        if (visitorData.success) {
          const totalVisitors = visitorData.count || 0;
          const recentVisitors = visitorData.visitors.slice(0, 10);
          
          // í†µê³„ ë°°ë„ˆ ì—…ë°ì´íŠ¸
          updateStatsBanner(totalVisitors, recentVisitors);
        }

        // ë³´ì•ˆ í†µê³„ ë¡œë“œ
        const securityResponse = await fetch('/visitor/security-stats');
        const securityData = await securityResponse.json();
        
        if (securityData.success) {
          updateSecurityStats(securityData);
        }
      } catch (error) {
        console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
      }
    }

    function updateStatsBanner(totalVisitors, recentVisitors) {
      const banner = document.querySelector('.stats-banner');
      if (banner) {
        const uniqueCountries = new Set(recentVisitors.map(v => v.country)).size;
        const uniqueIPs = new Set(recentVisitors.map(v => v.ip)).size;
        
        banner.innerHTML = `
          <h3>ğŸš€ ì‹œìŠ¤í…œ ì •ìƒ ê°€ë™ ì¤‘</h3>
          <p>ì´ ë°©ë¬¸ì: <strong>${totalVisitors.toLocaleString()}</strong>ëª… | 
             ìµœê·¼ 24ì‹œê°„: <strong>${recentVisitors.length}</strong>ëª… | 
             ì ‘ì† êµ­ê°€: <strong>${uniqueCountries}</strong>ê°œêµ­ | 
             ê³ ìœ  IP: <strong>${uniqueIPs}</strong>ê°œ</p>
          <p style="font-size: 0.9em; opacity: 0.9; margin-top: 10px;">
            ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${new Date().toLocaleTimeString('ko-KR')}
          </p>
        `;
      }
    }

    function updateSecurityStats(securityData) {
      // ë³´ì•ˆ í†µê³„ ìš”ì•½ ì¶”ê°€
      const container = document.querySelector('.container');
      let statsSection = document.getElementById('realtime-security-stats');
      
      if (!statsSection) {
        statsSection = document.createElement('div');
        statsSection.id = 'realtime-security-stats';
        statsSection.className = 'section';
        statsSection.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
        statsSection.style.color = 'white';
        
        // ì²« ë²ˆì§¸ section ë‹¤ìŒì— ì‚½ì…
        const firstSection = container.querySelector('.section');
        firstSection.parentNode.insertBefore(statsSection, firstSection.nextSibling);
      }

      const blockedIPs = securityData.blockedIPs?.length || 0;
      const suspiciousActivity = securityData.suspiciousActivity?.length || 0;
      const rateLimitHits = securityData.rateLimitHits || 0;

      statsSection.innerHTML = `
        <h2>ğŸ›¡ï¸ ì‹¤ì‹œê°„ ë³´ì•ˆ í˜„í™©</h2>
        <div class="grid grid-3col" style="margin-top: 20px;">
          <div style="background: rgba(255,255,255,0.15); padding: 25px; border-radius: 16px; text-align: center;">
            <div style="font-size: 3em; margin-bottom: 10px;">ğŸš«</div>
            <div style="font-size: 2.5em; font-weight: 700;">${blockedIPs}</div>
            <div style="opacity: 0.95; margin-top: 8px; font-size: 1.1em;">ì°¨ë‹¨ëœ IP</div>
          </div>
          <div style="background: rgba(255,255,255,0.15); padding: 25px; border-radius: 16px; text-align: center;">
            <div style="font-size: 3em; margin-bottom: 10px;">âš ï¸</div>
            <div style="font-size: 2.5em; font-weight: 700;">${suspiciousActivity}</div>
            <div style="opacity: 0.95; margin-top: 8px; font-size: 1.1em;">ì˜ì‹¬ í™œë™</div>
          </div>
          <div style="background: rgba(255,255,255,0.15); padding: 25px; border-radius: 16px; text-align: center;">
            <div style="font-size: 3em; margin-bottom: 10px;">ğŸš¦</div>
            <div style="font-size: 2.5em; font-weight: 700;">${rateLimitHits}</div>
            <div style="opacity: 0.95; margin-top: 8px; font-size: 1.1em;">Rate Limit</div>
          </div>
        </div>
        <p style="text-align: center; margin-top: 20px; opacity: 0.9; font-size: 0.95em;">
          ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${new Date().toLocaleTimeString('ko-KR')}
        </p>
      `;
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¡œë“œ
    loadRealTimeStats();
    
    // 30ì´ˆë§ˆë‹¤ ë°ì´í„° ê°±ì‹ 
    setInterval(loadRealTimeStats, 30000);
  </script>
</body>

</html>
}

/**
* Get security dashboard HTML